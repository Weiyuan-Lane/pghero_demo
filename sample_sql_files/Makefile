
init_db:
	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d postgres -c 'DROP DATABASE IF EXISTS ${DATABASE_NAME}_1 WITH (FORCE);'
	PGPASSWORD=${DATABASE_PASSWORD} createdb -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} ${DATABASE_NAME}_1
	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d ${DATABASE_NAME}_1 -c 'CREATE EXTENSION IF NOT EXISTS pg_stat_statements;'
	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d ${DATABASE_NAME}_1 -a -f ./northwind_modified.sql

	a=0; \
	while [ $$a -lt 100 ];\
	do\
		PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d ${DATABASE_NAME}_1 -a -f ./query_commands.sql >&/dev/null;\
		a=`expr $$a + 1`;\
	done

	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d postgres -c 'DROP DATABASE IF EXISTS ${DATABASE_NAME}_2 WITH (FORCE);'
	PGPASSWORD=${DATABASE_PASSWORD} createdb -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} ${DATABASE_NAME}_2
	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d ${DATABASE_NAME}_2 -c 'CREATE EXTENSION IF NOT EXISTS pg_stat_statements;'
	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d ${DATABASE_NAME}_2 -a -f ./northwind_modified.sql


psql:
	PGPASSWORD=${DATABASE_PASSWORD} psql -h ${DATABASE_HOST} -p ${DATABASE_PORT} -U ${DATABASE_USERNAME} -d postgres
